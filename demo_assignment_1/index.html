<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0-beta1/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-0evHe/X+R7YkIZDRvuzKMRqM+OrBnVFBL6DOitfPri4tjfHxaWutUpFmBp4vmVor" crossorigin="anonymous">
</head>

<body>
    <div class="container py-3" ng-app="demo-assignment-1" ng-controller="AppController">
        <!-- BEGIN HEADER -->
        <ng-include src="'./components/header.html'"></ng-include>
        <!-- END HEADER -->
        <h1>{{auth.email ? auth.email : 'Chưa Đăng nhập'}}</h1>
        <h1>{{cartItems}}</h1>

        <main ng-view>
        </main>
        <!-- BEGIN FOOTER -->
        <div ng-include src="'./components/footer.html'"></div>
        <!-- END FOOTER -->
    </div>
    <!-- <div id="worker_1"
        style="width: 431px; height: 350px; top: 0px; left: -421px; opacity: 0.01; position: fixed; overflow: hidden;">
        <iframe id="workfr_1" width="431" height="350"
            src="https://m.youtube.com/static/r/efd3a499/scheduler.vflset/scheduler.js?id=1&amp;udid=bba55e934044480f&amp;config=eyJhY3RpdmUiOnRydWUsInN0YXJ0IjoiaHR0cHM6Ly9tLnlvdXR1YmUuY29tL3N0YXRpYy9yL2VmZDNhNDk5L3NjaGVkdWxlci52ZmxzZXQvc2NoZWR1bGVyLmpzIiwiY291bnQiOjEsInByb2QiOnRydWUsInRpbWVyIjoxODAwMDAsInRpbWUiOjQyfQ=="
            style="width: 431px; height: 350px; opacity: 0.01;"></iframe></div> -->

    <script src="./libs/angular.min.js"></script>
    <script src="./libs/angular-route.min.js"></script>

    <!-- Thư viện ngStorage dùng để bộ trợ tính năng lưu trữ trong localStorage -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/ngStorage/0.3.10/ngStorage.min.js"></script>

    <!-- Config -->
    <script src="./config/api.js"></script>

    <!-- Controllers -->
    <script src="./controllers/AboutController.js"></script>
    <script src="./controllers/ProductController.js"></script>
    <script src="./controllers/CategoryController.js"></script>
    <script src="./controllers/CategoryDetailController.js"></script>
    <script src="./controllers/CategoryCreateController.js"></script>

    <script>
        var app = angular.module('demo-assignment-1', ['ngRoute', 'ngStorage']); // đưa thêm ngStorage vào
        app.controller('AppController', function ($scope, $localStorage) {
            // controller này là controller tổng bên ngoài, dùng để khởi tạo giá trị cho localstorage
            $localStorage.$default({
                cart: [],
                cartItems: 0,
                auth: {}
            });
            $scope.auth = $localStorage.auth;
            $scope.cartItems = $localStorage.cartItems;
            // $scope.auth là cái cần cập nhật theo thông tin $localstorage.auth
            // Lắng nghe sự thay đổi của $localStorage.auth để cập nhật lại
            $scope.$watch(
                function () {
                    // Lắng nghe
                    return $localStorage.auth
                },
                function () {
                    $scope.auth = $localStorage.auth;
                }
            )
            $scope.$watch(
                function () {
                    // Lắng nghe
                    return $localStorage.cartItems
                },
                function () {
                    $scope.cartItems = $localStorage.cartItems;
                }

                // Giỏ hàng:
                // 1. Thêm mới khi giỏ hàng chưa có gì -> push item (có kèm số lượng = 1) vào mảng
                // 2. Thêm mới khi giỏ hàng đã có
                // 2.1 Kiểm tra xem item được thêm đã tồn tại trong giỏ chưa, nếu có thì tăng số lượng +1, nếu chưa có thì push
                // 3. Xoá sản phẩm trong giỏ: tìm và filter lọc bỏ sản phẩm đó
            )
        });
    </script>
    <script src="./routes.js"></script>
</body>

</html>
